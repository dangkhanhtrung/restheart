(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"3dNW":function(e,t,a){"use strict";a.r(t);var n=a("Xp2Q"),r={props:{database:{type:String,default:"vuejx_cfg"},collection:{type:String,default:""},id:{type:String,default:""},site:{type:String,default:"guest"}},setup:function(e,t){var a=Object(n.a)(e,t);return{from:a.from,until:a.until,type:a.type,reindex:a.reindex,reindexAll:a.reindexAll}}},o=a("KHd+"),i=Object(o.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"default__screen"},[a("v-banner",{staticClass:"px-0",attrs:{"single-line":"",sticky:!0}},[a("v-btn",{staticStyle:{float:"left"},attrs:{text:"",icon:""},on:{click:function(t){return e.$router.go(-1)}}},[a("v-icon",[e._v("mdi-backburger")])],1),e._v(" "),a("v-toolbar-title",{staticStyle:{"max-width":"800px",float:"left"}},[e._v("Extension")])],1),e._v(" "),a("v-sheet",{staticClass:"mx-auto"},[a("v-tabs",{attrs:{vertical:"","background-color":"grey lighten-5"}},[a("v-tab",[a("v-icon",{attrs:{left:""}},[e._v("mdi-database-settings")]),e._v("ReIndex\n      ")],1),e._v(" "),a("v-tab",[a("v-icon",{attrs:{left:""}},[e._v("mdi-database-import")]),e._v("Import\n      ")],1),e._v(" "),a("v-tab-item",{attrs:{transition:"fade-transition","reverse-transition":"fade-transition"}},[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-subheader",{staticClass:"vjx_label"},[e._v("\n                  Start Date:\n                ")]),e._v(" "),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":e.from,transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(t){e.from=t},"update:return-value":function(t){e.from=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-text-field",e._g({staticClass:"v__border pt-0 mt-0",attrs:{"append-icon":"mdi-calendar-check",readonly:"",text:"",solo:""},model:{value:e.from,callback:function(t){e.from=t},expression:"from"}},n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.from,callback:function(t){e.from=t},expression:"from"}},[a("div",{staticClass:"flex-grow-1"}),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.from)}}},[e._v("OK")])],1)],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-subheader",{staticClass:"vjx_label"},[e._v("\n                  End Date:\n                ")]),e._v(" "),a("v-menu",{ref:"menu2",attrs:{"close-on-content-click":!1,"return-value":e.until,transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(t){e.until=t},"update:return-value":function(t){e.until=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-text-field",e._g({staticClass:"v__border pt-0 mt-0",attrs:{"append-icon":"mdi-calendar-check",readonly:"",text:"",solo:""},model:{value:e.until,callback:function(t){e.until=t},expression:"until"}},n))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[e._v(" "),a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.until,callback:function(t){e.until=t},expression:"until"}},[a("div",{staticClass:"flex-grow-1"}),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu2=!1}}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu2.save(e.until)}}},[e._v("OK")])],1)],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-subheader",{staticClass:"vjx_label"},[e._v("\n                  Type:\n                ")]),e._v(" "),a("v-autocomplete",{staticClass:"v__border",attrs:{items:[{value:!1,text:"Default"},{value:!0,text:"Clean"}],text:"",solo:"","hide-no-data":"","hide-details":"",multiple:!1,"return-object":!1,"small-chips":""},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm3:""}},[a("v-subheader",{staticClass:"vjx_label"},[e._v("\n                  Action:\n                ")]),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",[a("v-btn",{attrs:{outlined:"",dark:"",color:"primary",block:""},on:{click:e.reindex}},[e._v("Reindex")])],1),e._v(" "),a("v-flex",[a("v-btn",{attrs:{outlined:"",dark:"",color:"primary",block:""},on:{click:e.reindexAll}},[e._v("ReindexAll")])],1)],1)],1)],1)],1)],1)],1),e._v(" "),a("v-tab-item",{attrs:{transition:"fade-transition","reverse-transition":"fade-transition"}},[a("v-card",{attrs:{flat:""}},[a("v-card-text")],1)],1)],1)],1)],1)},[],!1,null,null,null);t.default=i.exports},Xp2Q:function(module,__webpack_exports__,__webpack_require__){"use strict";var vue_function_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("hTPA"),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("8SHQ");function asyncGeneratorStep(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(e){return void a(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function _asyncToGenerator(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var o=e.apply(t,a);function i(e){asyncGeneratorStep(o,n,r,i,l,"next",e)}function l(e){asyncGeneratorStep(o,n,r,i,l,"throw",e)}i(void 0)})}}function service(props,ctx){var loading=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(!1),render=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(!1),api=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(_config__WEBPACK_IMPORTED_MODULE_1__.a.vuejx),apiReindexAll=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(_config__WEBPACK_IMPORTED_MODULE_1__.a.reindexAll),postData=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)({}),metadataConfig=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)({}),valid=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(!1),from=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(null),until=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(null),type=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(!1),sites=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)([]),siteSelected=Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.value)(props.site);Object(vue_function_api__WEBPACK_IMPORTED_MODULE_0__.onDestroyed)(function(){clean()});var clean=function(){loading.value=!1,render.value=!1,api.value="",postData.value=null,metadataConfig.value=null,valid.value=null},pullConfig=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(""===props.collection){_context.next=3;break}return _context.next=3,ctx.parent.$store.dispatch("vuejx_manager/pullDB",{db:"vuejx_cfg",collection:"vuejx_collection",params:{filter:{shortName:props.collection}}}).then(function(data){void 0!==data&&data.hasOwnProperty("_embedded")?metadataConfig.value=eval("("+data._embedded[0].metadataConfig+")").form:metadataConfig.value={}}).catch(function(e){metadataConfig.value={}});case 3:case"end":return _context.stop()}},_callee)}));return function(){return _ref.apply(this,arguments)}}(),pullDetail=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(pullConfig(),"_schemas"!==props.collection){e.next=6;break}return e.next=4,ctx.parent.$store.dispatch("vuejx_manager/pullDB",{db:props.database,collection:props.collection,params:{pagesize:1e3}}).then(function(e){postData.value=e._embedded.find(function(e){return console.log(e._id,props.id),e._id===props.id}),console.log(postData.value);var t={};for(var a in postData.value)"_id"!==a&&"id"!==a&&"$schema"!==a&&"_etag"!==a&&(t[a]=postData.value[a]);postData.value.shortName=postData.value._id,postData.value.tableConfig=JSON.stringify(t),console.log(t),postData.value.tableConfig=void 0!==postData.value.tableConfig?postData.value.tableConfig:"{}"}).catch(function(e){postData.value={}});case 4:e.next=8;break;case 6:return e.next=8,ctx.parent.$store.dispatch("vuejx_manager/pullDBDetail",{db:props.database,collection:props.collection,id:props.id}).then(function(e){postData.value=e}).catch(function(e){postData.value={}});case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),toPage=function(e){var t=window.Vue.$router.history.current.params;Vue.redirect(null,!1,"/admin/"+(void 0!==t.database?t.database:"vuejx_cfg")+"/"+e+"/"+(void 0!==t.site?t.site:"guest"),!0)},refresh=function(){location.reload(!0)},addData=function(){ctx.refs.form.validate()&&(postData.value.site=props.site,loading.value=!0,"_schemas"!==props.collection?ctx.parent.$store.dispatch("vuejx_manager/postDB",{db:props.database,collection:props.collection,data:postData.value}).then(function(e){loading.value=!1,backURL()}).catch(function(e){loading.value=!1}):ctx.parent.$store.dispatch("vuejx_manager/putDB",{db:props.database,collection:props.collection,id:postData.value.shortName,data:JSON.parse(postData.value.tableConfig)}).then(function(e){loading.value=!1,backURL()}).catch(function(e){loading.value=!1}))},editData=function(e){ctx.refs.form.validate()&&(postData.value.site=props.site,loading.value=!0,ctx.parent.$store.dispatch("vuejx_manager/putDB",{db:props.database,collection:props.collection,id:props.id,data:postData.value}).then(function(t){loading.value=!1,window.Vue.toastr.success("Success."),0===e&&backURL()}).catch(function(e){loading.value=!1}))},removeData=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ctx.parent.$store.dispatch("vuejx_manager/removeDB",{db:props.database,collection:props.collection,id:props.id,data:{storeDb:postData.value.storeDb,shortName:postData.value.shortName}});case 2:backURL();case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),backURL=function(){Vue.$router.go(-1)},toURL=function(e){Vue.redirect(null,!1,e)},reindex=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ctx.parent.$store.dispatch("vuejx_manager/pullQuery",{api:_config__WEBPACK_IMPORTED_MODULE_1__.a.reindex,db:props.database,collection:props.collection,params:{from:null!==from.value?new Date(from.value).getTime():"",until:null!==until.value?new Date(until.value).getTime():"",type:type.value}}).then(function(e){}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),reindexAll=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ctx.parent.$store.dispatch("vuejx_manager/pullDB",{db:"vuejx_cfg",collection:"vuejx_collection",params:{pagesize:1e3}}).then(function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=e._embedded[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;ctx.parent.$store.dispatch("vuejx_manager/pullQuery",{api:_config__WEBPACK_IMPORTED_MODULE_1__.a.reindex,db:i.storeDb,collection:i.shortName,params:{from:null!==from.value?new Date(from.value).getTime():"",until:null!==until.value?new Date(until.value).getTime():"",type:type.value}}).then(function(e){}).catch(function(e){console.log(e)})}}catch(e){a=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),mergeOAI=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Vue.redirect(null,!1,"/admin/"+props.database+"/"+props.collection+"/"+props.site+"/"+props.id+"/async/"+postData.value.shortName+"/"+postData.value.storeCollection);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),doChangeSite=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Vue.redirect(null,!1,"/admin/"+props.database+"/"+props.collection+"/"+siteSelected.value);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),asyncOAI=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ctx.parent.$store.dispatch("vuejx_manager/pullAPI",{api:_config__WEBPACK_IMPORTED_MODULE_1__.a.async+props.id,params:{from:null!==from.value?new Date(from.value).getTime():"",until:null!==until.value?new Date(until.value).getTime():""}}).then(function(e){}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),initSite=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={_source:{includes:["shortName","title"]},query:{bool:{}}},e.next=3,ctx.parent.$store.dispatch("vuejx_manager/pullDBES",{query:"\n                query search($token: String, $body: JSON, $db: String, $collection: String) {\n                    results: search(token: $token, body: $body, db: $db, collection: $collection )\n                }\n            ",variables:{body:t,db:"vuejx_cfg",collection:"vuejx_site"}}).then(function(e){void 0!==e.results&&null!==e.results?sites.value=e.results.hits.hits:sites.value=[]}).catch(function(e){sites.value=[]});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return{clean:clean,loading:loading,postData:postData,valid:valid,toPage:toPage,addData:addData,refresh:refresh,backURL:backURL,editData:editData,toURL:toURL,api:api,pullDetail:pullDetail,metadataConfig:metadataConfig,render:render,pullConfig:pullConfig,removeData:removeData,reindex:reindex,from:from,until:until,type:type,mergeOAI:mergeOAI,asyncOAI:asyncOAI,initSite:initSite,sites:sites,doChangeSite:doChangeSite,siteSelected:siteSelected,apiReindexAll:apiReindexAll,reindexAll:reindexAll}}__webpack_exports__.a=service}}]);