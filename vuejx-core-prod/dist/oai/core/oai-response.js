"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var xml=require("xml"),exceptions_1=require("./exceptions/exceptions"),responseTemplate={"OAI-PMH":[{_attr:{xmlns:"http://www.openarchives.org/OAI/2.0/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:dc":"http://purl.org/dc/elements/1.1/","xsi:schemaLocation":"http://www.openarchives.org/OAI/2.0/ \nhttp://www.openarchives.org/OAI/2.0/OAI-PMH.xsd"}},{responseDate:(new Date).toISOString()}]};function generateResponse(e,t,r){var n=JSON.parse(JSON.stringify(responseTemplate));return n["OAI-PMH"].push({request:[{_attr:{verb:e.verb,metadataPrefix:void 0!==e.metadataPrefix?e.metadataPrefix:"",resumptionToken:void 0!==e.resumptionToken?e.resumptionToken:""}},t]}),n["OAI-PMH"].push(r),n["OAI-PMH"].push({resumptionToken:r.resumptionToken}),xml(n,{declaration:!0})}function generateException(e,t){if(void 0===t)throw new Error("Function arguments are missing:  code: "+t);if(exceptions_1.Exceptions.getExceptionMessage(t)===exceptions_1.Exceptions.UNKNOWN_CODE)throw new Error("Unknown exception type: "+t);var r=JSON.parse(JSON.stringify(responseTemplate));return e.verb&&e.identifier&&e.metadataPrefix?r["OAI-PMH"].push({request:[{_attr:{verb:e.verb,identifier:e.identifier,metadataPrefix:e.metadataPrefix}},e.baseUrl]}):e.verb&&e.identifier?r["OAI-PMH"].push({request:[{_attr:{verb:e.verb,identifier:e.identifier}},e.baseUrl]}):e.verb?r["OAI-PMH"].push({request:[{_attr:{verb:e.verb}},e.baseUrl]}):r["OAI-PMH"].push({request:e.baseUrl}),r["OAI-PMH"].push({error:[{_attr:{code:t}},exceptions_1.Exceptions.getExceptionMessage(t)]}),xml(r,{declaration:!0})}exports.generateResponse=generateResponse,exports.generateException=generateException;